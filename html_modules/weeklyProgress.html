<head>
    <style type="text/css">

        #three {
            display: flex;
            justify-content: space-around;
        }

        #header {
            font-style: italic;
            font-size: 150%;
        }

        .titel {
            font-style: italic;
            text-align: center;
        }

        .text {
            font-style: italic;
            text-align: center;
            font-weight: bold;
            font-size: 300%;
            color: #C84B4B;
        }
    </style>

    <script>

        var views; 
        var posts; 

        function loadScript(url, callback)
        {
            // Adding the script tag to the head as suggested before
            var head = document.head;
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = url;

            // Then bind the event to the callback function.
            // There are several events for cross browser compatibility.
            script.onreadystatechange = callback;
            script.onload = callback;

            // Fire the loading
            head.appendChild(script);
        }

        var generateNumbers = function() {

            var userEmail = analytics._user._getTraits().email;

            var discussionData = JSON.parse(discussionMapping);

          
            for (var i = 0; i < discussionData.length; i++) {
              
              
                if (discussionData[i].Email == userEmail)
                {
                    views = discussionData[i].Views; 
                    posts = discussionData[i].Posts; 
                }
            }

            console.log("views" + views);
            console.log("posts" + posts);


            document.getElementById("numViews").innerHTML = views; 
            document.getElementById("numPosts").innerHTML = posts; 
        }


        /**** LOAD THE CHART ***/ 

        var generateLineChart = function () {

            var chart = new CanvasJS.Chart("chartContainer", {
                theme:"light2",
                animationEnabled: true,
                title:{
                    text: "Class Progress"
                },
                axisY :{
                    includeZero: true,
                    title: "Number of Actions",
                    suffix: ""
                },
                toolTip: {
                    shared: "true"
                },
                legend:{
                    cursor:"pointer",
                    itemclick : toggleDataSeries
                },
                data: [{
                    type: "spline", 
                    showInLegend: true,
                    yValueFormatString: "",
                    name: "Videos Watched",
                    dataPoints: [
                    { label: "Week 1", y: 2 },
                    { label: "Week 2", y: 2 },
                    { label: "Week 3", y: 2 },
                    { label: "Week 4", y: 2 },
                    { label: "Week 5", y: 2 },
                    { label: "Week 6", y: 2 },
                    { label: "Week 7", y: 2 },
                    { label: "Week 8", y: 2 },
                    { label: "Week 9", y: 2 },
                    { label: "Week 10", y: 2 }
                    ]
                },
                {
                    type: "spline", 
                    showInLegend: true,
                    yValueFormatString: "",
                    name: "Posts Viewed",
                    dataPoints: [
                    { label: "Week 1", y: 8 },
                    { label: "Week 2", y: 6.81 },
                    { label: "Week 3", y: 6.71 },
                    { label: "Week 4", y: 6.82 },
                    { label: "Week 5", y: 6.56 },
                    { label: "Week 6", y: 6.24 },
                    { label: "Week 7", y: 5.40 },
                    { label: "Week 8", y: 7.01 },
                    { label: "Week 9", y: 7.14 },
                    { label: "Week 10", y: 8.11 }
                    ]
                },
                {
                    type: "spline", 
                    showInLegend: true,
                    yValueFormatString: "",
                    name: "Posts Replied",
                    dataPoints: [
                    { label: "Week 1", y: 7.94 },
                    { label: "Week 2", y: 7.29 },
                    { label: "Week 3", y: 7.28 },
                    { label: "Week 4", y: 7.82 },
                    { label: "Week 5", y: 7.89 },
                    { label: "Week 6", y: 6.71 },
                    { label: "Week 7", y: 7.80 },
                    { label: "Week 8", y: 7.60 },
                    { label: "Week 9", y: 7.66 },
                    { label: "Week 10", y: 8.89 }
                    ]
                },
                {
                    type: "spline", 
                    showInLegend: true,
                    yValueFormatString: "",
                    name: "Assignments Completed",
                    dataPoints: [
                    { label: "Week 1", y: 10.11 },
                    { label: "Week 2", y: 9.27 },
                    { label: "Week 3", y: 9.25 },
                    { label: "Week 4", y: 10.17 },
                    { label: "Week 5", y: 10.72 },
                    { label: "Week 6", y: 10.24 },
                    { label: "Week 7", y: 12.07 },
                    { label: "Week 8", y: 0},
                    { label: "Week 9", y: 0},
                    { label: "Week 10", y: 0},
                    ]
                }]
            });
            chart.render();

            function toggleDataSeries(e) {
                if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible ){
                    e.dataSeries.visible = false;
                } else {
                    e.dataSeries.visible = true;
                }
                chart.render();
            }

        };
    </script>


</head>

<body>
    <div id="startPlan">

      <p id="header">In the past week of the course (9/15/22 - 9/22/2019) you have:</p>

      <br>

      <div id="three">
        <div id="col1">
            <div id="vidIntended" class="text">3</div>
            <div class="vidFeedback titel">Watched Videos</div>
        </div>
        <div id="col2">
            <div id="questionIntended" class="text">2</div>
            <div class="quizFeedback titel">Tried Problems</div>
        </div>
        <div id="col3">
            <div id="numViews" class="text">1</div>
            <div class="timeFeedback titel">View Posts</div>
        </div>
        <div id="col4">
            <div id="numPosts" class="text">4</div>
            <div class="timeFeedback titel">Post Times</div>
        </div>
    </div>

    <br>
    <br>

    <p id="header">Your overall course progress:</p>

    <div id="chartContainer" style="height: 300px; width: 100%;"> 
        <script> 
            loadScript("/static/DiscussionMapping.js", generateNumbers);
            loadScript("https://canvasjs.com/assets/script/canvasjs.min.js", generateLineChart);
        </script>

    </div>

</div>

</body>


